# Trigger test environment deploy when code is pushed to main
name: Deploy to Test

on:
    push:
        branches: [main]

jobs:
    trigger-deploy:
        name: Trigger test environment deploy
        runs-on: ubuntu-latest
        steps:
            - name: Dispatch deploy to isce-infra
              uses: peter-evans/repository-dispatch@v3
              with:
                  token: ${{ secrets.DEPLOY_PAT }}
                  repository: iscedcs/isce-infra
                  event-type: deploy-test
                  client-payload: '{"service": "isce-auth-web", "repo": "${{ github.repository }}", "sha": "${{ github.sha }}"}'
